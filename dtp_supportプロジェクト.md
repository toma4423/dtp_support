承知いたしました。streamlitアプリケーション「日本語DTP名寄せツール」の詳細仕様書を以下に作成します。

**詳細仕様書：日本語DTP名寄せツール**

**1. 概要**

本アプリケーションは、streamlitを用いて構築されたWebアプリケーションであり、ユーザーがアップロードした名簿リスト（CSV, Excel）に含まれる日本語氏名を、指定された文字数（5字または7字）で整形し、DTP処理に適した形式で出力します。

**2. 目的**

* DTP作業における氏名整形作業の効率化
* 名簿リストの氏名表記統一による品質向上
* 手作業によるミス削減

**3. 機能要件**

* **ファイルアップロード機能:**
    * CSV形式またはExcel形式（.xlsx）の名簿リストをアップロード可能。
    * アップロード可能なファイルサイズに制限を設ける（例：10MB）。
* **氏名分割機能:**
    * アップロードされた名簿リストから氏名列を抽出し、「苗字」と「名前」に分割する。
    * 苗字リスト（テキストファイル）を読み込み、リストと照合して苗字を特定する。
    * 苗字リストにない氏名は、エラーとして検出し、ユーザーに通知する。
    * 外国籍の方の氏名など、例外的な氏名に対応できるように設計をする。
* **文字数整形機能:**
    * ラジオボタンにより、「5字取り」または「7字取り」を選択可能。
    * 選択された文字数で、分割された氏名を整形する。
    * 氏名が指定文字数より短い場合は、空白文字で埋める。
    * 文字取り処理は、文字列の長さに応じて空白文字を追加するなどの処理をおこなう。
    * 字取り方法（例：中央揃え、右揃え）をユーザーが選択可能とする。また、文字間を空ける、詰めると言った処理も実装をする。
* **処理結果出力機能:**
    * 整形後の氏名を含む名簿リストを、元のファイル形式（CSVまたはExcel）で出力する。
    * 出力されたファイルをダウンロード可能とする。
* **エラー処理:**
    * ファイル形式の不一致、氏名分割の失敗、文字数整形のエラーなど、各種エラーを検出し、ユーザーに分かりやすいエラーメッセージを表示する。
    * エラー個所を特定しやすくする。
* **UI/UX:**
    * streamlitのサイドバーの活用。条件設定、ヘルプ機能の設置。
    * 直感的で使いやすいインターフェースとする。
    * 処理の進捗状況を表示する。

**4. 非機能要件**

* **パフォーマンス:**
    * 一般的な名簿リスト（数千件程度）を数秒以内に処理する。
* **セキュリティ:**
    * アップロードされたファイルは、処理完了後にサーバーから削除する。
* **保守性:**
    * コードは可読性が高く、保守・修正が容易であること。

**5. 入出力**

* **入力:**
    * CSV形式またはExcel形式の名簿リストファイル
    * 苗字リストのテキストファイル
    * 文字数整形オプション（5字取り/7字取り）
* **出力:**
    * 整形後の氏名を含む名簿リストファイル（CSVまたはExcel）

**6. 画面構成**

1.  **ファイルアップロード画面:**
    * ファイルアップロードボタン
    * 苗字リストアップロードボタン
    * 文字数整形オプション（ラジオボタン）
2.  **処理実行画面:**
    * 処理実行ボタン
    * 進捗状況表示
    * エラーメッセージ表示
3.  **処理結果画面:**
    * ダウンロードボタン

**7. 使用技術**

* Python
* streamlit
* pandas
* openpyxl,csv(ファイル形式による)
* 苗字分割ライブラリ(GiNZA,SudachiPy等)

**8. その他**

* 本仕様書は、開発の進捗状況に応じて変更される場合があります。
* streamlit cloudの利用をする。
* バージョン管理システムの利用をする。
* テスト駆動開発（TDD）の導入をする。
* ログ機能の追加をする。

この仕様書を元に、開発を進めていきます。
